\hypertarget{_basis_obj_8h_source}{}\doxysection{Basis\+Obj.\+h}
\mbox{\hyperlink{_basis_obj_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00001}00001 \textcolor{preprocessor}{\#ifndef BASIS\_OBJ\_HH}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00002}00002 \textcolor{preprocessor}{\#define BASIS\_OBJ\_HH}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00004}00004 \textcolor{preprocessor}{\#include <splines2Armadillo.h>}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00005}00005 }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00006}00006 \textcolor{comment}{// for integration}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00007}00007 \textcolor{preprocessor}{\#include "{}numerical\_integration.hpp"{}}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00008}00008 \textcolor{preprocessor}{\#include "{}Adams\_rule.hpp"{}}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00009}00009 }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00010}00010 \textcolor{keyword}{using namespace }apsc::NumericalIntegration;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00011}00011 \textcolor{keyword}{using }apsc::NumericalIntegration::FunPoint;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00012}00012 \textcolor{keyword}{using }apsc::NumericalIntegration::Simpson;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00013}00013 \textcolor{keyword}{using namespace }Geometry;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00014}00014 }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00015}\mbox{\hyperlink{_basis_obj_8h_ac2c660c6ec7dfa9d92fdb67603ada768}{00015}} \textcolor{keyword}{enum class} \mbox{\hyperlink{_basis_obj_8h_ac2c660c6ec7dfa9d92fdb67603ada768}{BasisEnum}} \{  \textcolor{comment}{// TODO use for template, ALSO why class?}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00016}00016   \mbox{\hyperlink{_basis_obj_8h_ac2c660c6ec7dfa9d92fdb67603ada768a123732cee284ea8ed914cfe1bb999a8d}{BSPLINE}} = 0}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00017}00017 \};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00019}00019 \textcolor{keyword}{template}<BasisEnum b>}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00020}\mbox{\hyperlink{class_fd_handler}{00020}} \textcolor{keyword}{class }\mbox{\hyperlink{class_fd_handler}{FdHandler}} \{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00021}00021 }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00022}\mbox{\hyperlink{class_fd_handler_ae46931ae8d228780c6a27244637b616c}{00022}}   \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_fd_handler_ae46931ae8d228780c6a27244637b616c}{operator()}}(\textcolor{keyword}{const} arma::mat\& coef, \textcolor{keywordtype}{unsigned} i,\textcolor{keywordtype}{double} t) = 0;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00023}00023   }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00024}00024   }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00025}00025 \};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00027}00027 \textcolor{keyword}{template}<>}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00028}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4}{00028}} \textcolor{keyword}{class }\mbox{\hyperlink{class_fd_handler}{FdHandler}}<\mbox{\hyperlink{_basis_obj_8h_ac2c660c6ec7dfa9d92fdb67603ada768}{BasisEnum}}::\mbox{\hyperlink{_basis_obj_8h_ac2c660c6ec7dfa9d92fdb67603ada768a123732cee284ea8ed914cfe1bb999a8d}{BSPLINE}}>\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00029}00029 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00030}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_addc56bddd2bd702ab37da813fecc45c2}{00030}}   \textcolor{keyword}{explicit} \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_addc56bddd2bd702ab37da813fecc45c2}{FdHandler}}(splines2::BSpline \&\& bspline\_basis) : }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00031}00031     basis(std::move(bspline\_basis)), N(21), quad(Simpson(), Mesh1D(Domain1D(0,1), N)),}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00032}00032     keep\_bases\_(basis.get\_spline\_df())\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00033}00033     }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00034}00034       arma::vec a\_b = this-\/>basis.get\_boundary\_knots();}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00035}00035       this-\/>domain = Domain1D(a\_b[0], a\_b[1]);}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00036}00036       this-\/>mesh = Mesh1D(domain, this-\/>N);}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00037}00037       \textcolor{comment}{// this-\/>basis\_integrals.resize(keep\_bases, keep\_bases)}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00038}00038     }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00039}00039     }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00040}00040   \};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00041}00041   }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00042}00042   \textcolor{comment}{// TODO static polymorphism}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00043}00043   \textcolor{comment}{// evaluate at point t a sample }}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00044}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a40f725558b37f5cee662a1c5f20cc7ce}{00044}}   \textcolor{keywordtype}{double} \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a40f725558b37f5cee662a1c5f20cc7ce}{operator()}}(\textcolor{keyword}{const} arma::mat\& coef, \textcolor{keywordtype}{unsigned} i,\textcolor{keywordtype}{double} t)\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00045}00045     }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00046}00046     this-\/>basis.set\_x(splines2::rvec\{t\});}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00047}00047     arma::mat basis\_eval = this-\/>basis.basis(\textcolor{keyword}{true}); \textcolor{comment}{// true to include intercept}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00048}00048     \textcolor{comment}{// (basis\_eval * coefs\_arma).eval()(0,0)}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00049}00049     \textcolor{keywordflow}{return} (basis\_eval * coef.col(i)).eval()(0,0); }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00050}00050     }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00051}00051   \};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00052}00052   }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00053}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a317c429418920af0999162442b523920}{00053}}   \textcolor{keyword}{inline} FunPoint \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a317c429418920af0999162442b523920}{basis\_function}}(\textcolor{keywordtype}{unsigned} basis\_idx)\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00054}00054     \textcolor{keywordflow}{return} [\textcolor{keyword}{this}, basis\_idx](\textcolor{keywordtype}{double} t) -\/> \textcolor{keywordtype}{double} \{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00055}00055       this-\/>basis.set\_x(splines2::rvec\{t\});}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00056}00056       arma::mat basis\_eval= this-\/>basis.basis(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00057}00057       \textcolor{keywordflow}{return} basis\_eval.eval()(0, basis\_idx);}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00058}00058       \};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00059}00059     \};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00060}00060   \textcolor{comment}{// TODO use weight function.  }}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00061}00061   }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00062}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a459537307ff8a19092b4c1d620cb469a}{00062}}   \textcolor{keyword}{inline} arma::mat \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a459537307ff8a19092b4c1d620cb469a}{compute\_dissim\_matrix}}(\textcolor{keyword}{const} arma::mat\& X\_coef)\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00063}00063     arma::mat dis\_mat = arma::mat(X\_coef.n\_cols, X\_coef.n\_cols);}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00064}00064 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00065}00065     std::cout << \textcolor{stringliteral}{"{}Computing dissimilarity matrix"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00066}00066 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00067}00067     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < X\_coef.n\_cols; i++)\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00068}00068 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00069}00069       std::cout << \textcolor{stringliteral}{"{}Column "{}} << i << \textcolor{stringliteral}{"{} of "{}} << X\_coef.n\_cols<< std::endl;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00070}00070 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00071}00071       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = i+1; j < X\_coef.n\_cols; j++)\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00072}00072         dis\_mat(i,j) = quad.apply([\textcolor{keyword}{this}, i,j, \&X\_coef](\textcolor{keywordtype}{double} t)-\/> \textcolor{keywordtype}{double}\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00073}00073           \textcolor{keywordflow}{return} ((*\textcolor{keyword}{this})(X\_coef, i, t) -\/ (*\textcolor{keyword}{this})(X\_coef, j, t) )*((*\textcolor{keyword}{this})(X\_coef, i, t) -\/ (*\textcolor{keyword}{this})(X\_coef, j, t) );}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00074}00074           \}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00075}00075         );}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00076}00076         dis\_mat(j,i) = dis\_mat(i,j); }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00077}00077 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00078}00078         std::cout << \textcolor{stringliteral}{"{}(i,j); "{}} << i << \textcolor{stringliteral}{"{} , "{}}<< j << \textcolor{stringliteral}{"{} is "{}} << dis\_mat(i,j)<< std::endl;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00079}00079 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00080}00080       \}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00081}00081       }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00082}00082     \}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00083}00083     \textcolor{keywordflow}{return} dis\_mat;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00084}00084   \} }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00085}00085   }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00086}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_ac66235b4035349b3559434e88e2263de}{00086}}   \textcolor{keyword}{inline} arma::mat \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_ac66235b4035349b3559434e88e2263de}{compute\_features}}(\textcolor{keyword}{const} arma::mat \& X\_coef, \textcolor{keywordtype}{unsigned} n\_feats)\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00087}00087     this-\/>compute\_basis\_integrals(n\_feats);}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00088}00088     \textcolor{comment}{// X\_coef is df x n\_samples ;}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00089}00089     \textcolor{comment}{// basis integrals is df x features}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00090}00090     \textcolor{comment}{// returns a matrix of n\_samples * n\_feats}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00091}00091     \textcolor{keywordflow}{return}  X\_coef.t() * this-\/>basis\_integrals;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00092}00092   \}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00093}00093   }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00094}00094 \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00095}00095   \textcolor{comment}{// members}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00096}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_ab7cbbc0966714326995b3a4afe3f99f6}{00096}}   \textcolor{keywordtype}{double} \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_ab7cbbc0966714326995b3a4afe3f99f6}{a}}, b;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00097}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a51abb649872e4f5135a900b10e5810fb}{00097}}   \textcolor{keywordtype}{unsigned} n\_feats=0;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00098}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_ad60969c9c0dad9e3326b1258c545c49b}{00098}}   splines2::BSpline \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_ad60969c9c0dad9e3326b1258c545c49b}{basis}};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00099}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a9f4fd262e0a387156808ee311ea032e6}{00099}}   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a9f4fd262e0a387156808ee311ea032e6}{N}};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00100}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_ad1d3587235ff3c182e34973d65ef241c}{00100}}   Domain1D \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_ad1d3587235ff3c182e34973d65ef241c}{domain}};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00101}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_aa3f248c844f5f317b024cb81f09edc6c}{00101}}   Mesh1D   \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_aa3f248c844f5f317b024cb81f09edc6c}{mesh}};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00102}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a4a7c0a076c1410871989a21ffd615197}{00102}}   Quadrature \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a4a7c0a076c1410871989a21ffd615197}{quad}};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00103}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a5dd3d2c486c42000fe9107e07a9efb2f}{00103}}   \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a5dd3d2c486c42000fe9107e07a9efb2f}{keep\_bases\_}};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00104}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_adc6cbd2f15217af188b230225fe9be83}{00104}}   arma::mat \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_adc6cbd2f15217af188b230225fe9be83}{basis\_integrals}};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00105}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a5316f1143f2617a90a60a50e4805e655}{00105}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a5316f1143f2617a90a60a50e4805e655}{compute\_basis\_integrals}}(\textcolor{keywordtype}{unsigned} n\_feats)\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00106}00106     this-\/>basis\_integrals.set\_size(keep\_bases\_,n\_feats);}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00107}00107     \textcolor{comment}{// TODO Pragma}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00108}00108     \textcolor{keywordtype}{double} I = domain.right() -\/ domain.left();}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00109}00109     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_feats; j++)\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00110}00110       \textcolor{keywordtype}{double} lb = this-\/>domain.left() + j*I / (n\_feats);}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00111}00111       \textcolor{keywordtype}{double} up = this-\/>domain.left() + (j+1)*I/ (n\_feats); }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00112}00112 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00113}00113       std::cout << \textcolor{stringliteral}{"{}Current lb, up of integration for bases are: "{}} << lb << \textcolor{stringliteral}{"{} "{}} << up << std::endl;}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00114}00114 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00115}00115       \textcolor{keyword}{auto} weight\_basis = [lb, up](\textcolor{keywordtype}{double} \textcolor{keyword}{const}\&x) -\/> \textcolor{keywordtype}{double}\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00116}00116         \textcolor{keywordflow}{return} (x < up and x>= lb) ? 1 : 0;  \textcolor{comment}{// step function}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00117}00117       \};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00118}00118       }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00119}00119       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k=0; k < keep\_bases\_; k++)\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00120}00120         \textcolor{keyword}{auto} meshgen = VariableSize(this-\/>domain, weight\_basis, this-\/>N);}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00121}00121         \textcolor{comment}{// this-\/>quad = Quadrature(Trapezoidal(), meshgen);}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00122}00122         basis\_integrals(k, j) = quad.apply(}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00123}00123           [\&weight\_basis,k,\textcolor{keyword}{this}](\textcolor{keywordtype}{double} t)\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00124}00124             \textcolor{keywordflow}{return} weight\_basis(t) * this-\/>basis\_function(k)(t);}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00125}00125           \}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00126}00126         );}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00127}00127       \}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00128}00128     \}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00129}00129   \}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00130}00130     }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00131}\mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a7487cb517c3fa55330716f105270bed4}{00131}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_fd_handler_3_01_basis_enum_1_1_b_s_p_l_i_n_e_01_4_a7487cb517c3fa55330716f105270bed4}{compute\_basis\_squared\_integrals}}(\textcolor{keywordtype}{unsigned} n\_feats)\{}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00132}00132     }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00133}00133   \}}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00134}00134   }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00135}00135   }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00136}00136 \};}
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00137}00137 }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00138}00138 }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00139}00139 }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00140}00140 }
\DoxyCodeLine{\Hypertarget{_basis_obj_8h_source_l00141}00141 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// basis object}}

\end{DoxyCode}
